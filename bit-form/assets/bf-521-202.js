var z=Object.defineProperty;var $=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var T=(d,r,t)=>r in d?z(d,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[r]=t,j=(d,r)=>{for(var t in r||(r={}))K.call(r,t)&&T(d,t,r[t]);if($)for(var t of $(r))U.call(r,t)&&T(d,t,r[t]);return d};import{u as V,j as e,aT as w,r as k,a as D,_ as i,z as S,aQ as M,b as _,L as W,Y as I,B as G,c as J}from"./main-232.js";/* empty css          */import{B as Q}from"./bf-678-70.js";import{B as g}from"./bf-86-126.js";import"./bf-106-80.js";function Y(d,r={},t=[]){const m={form_fields:[]},f=Object.keys(r),h={form_fields:[]},x=[];f.forEach(a=>{const c=r[a].lg.map(o=>o.i);d.forEach(o=>{if(o.key===a){if(!t.includes(o.typ)){let p="";o.typ==="repeater"?p=`${o.lbl}_(Repeater)`:o.typ==="section"&&(p=`${o.lbl}_(Section)`),h[p]||(h[p]={flds:[],key:a}),h[p].flds=c}x.push(...c)}})});const y=Object.keys(h);return d.forEach(a=>{y.forEach(c=>{const o=h[c].flds,p=h[c].key;o&&o.includes(a.key)&&(m[c]||(m[c]=[]),a.newKey=`${p}.${a.key}`,m[c].push(a))}),!x.includes(a.key)&&!t.includes(a.typ)&&m.form_fields.push(a)}),m}function q({formFields:d,notAllowFieldType:r=[],shortCode:t=!1}){const m=V(w),f=Y(d,m,r),h=Object.keys(f),x=a=>(a.charAt(0).toUpperCase()+a.slice(1)).replace(/_/g," "),y=a=>{const c=a.newKey?a.newKey:a.key;return t?`\${${c}}`:c};return h.map(a=>e.jsx("optgroup",{label:x(a),children:f[a].map(c=>e.jsx("option",{value:y(c),children:c.name},`ff-zhcrm-${c.key}`))},`fld-lbl-${a}`))}function ae({formID:d,formFields:r,webHooks:t,setWebHooks:m,step:f,setstep:h,setSnackbar:x,create:y,isInfo:a}){var C;const c=s=>s==null?void 0:s.match(/(\?|&)([^=]+)=([^&]+|)/gi),[o,p]=k.useState(!1),E=["GET","POST","PUT","PATCH","OPTION","DELETE","TRACE","CONNECT"],{css:O}=D(),v=k.useRef(null),L=s=>{try{return JSON.stringify(s,null,2)}catch(l){return s}},A=s=>{p(!0),J({hookDetails:s},"bitforms_test_webhook").then(l=>{if(l&&l.success)v.current.innerHTML=`<pre>${L(l.data.response)}</pre>`,x({show:!0,msg:i(l.data.msg)}),p(!1);else if(l&&l.data){const n=typeof l.data=="string"?l.data:"Unknown error";x({show:!0,msg:`${n}. ${i("please try again")}`}),p(!1)}else x({show:!0,msg:i("Webhook tests failed. please try again")}),p(!1)})},b=(s,l,n)=>{const u=j({},t);l!==""?s==="key"?u.url=u.url.replace(n,`${n.charAt(0)}${l}=${n.split("=")[1]}`):u.url=u.url.replace(n,`${n.split("=")[0]}=${l}`):n.match(/\?/g)===null?u.url=u.url.replace(n,""):u.url=u.url.replace(`${n}&`,"?"),m(u)},N=s=>{const l=j({},t);l[s.target.name]=s.target.value,m(j({},l))},F=(s,l)=>{const n=j({},t),u=l.split("=");u[1]=s,n.url=n.url.replace(l,u.join("=")),m(n)},B=()=>{const s=j({},t);s.url.match(/\?/g)!==null?s.url+="&key=value":s.url+="?key=value",m(s)},P=s=>{const l=j({},t);l.url=l.url.replace(s,""),m(l)},R=()=>{setTimeout(()=>{document.getElementById("btcd-settings-wrp").scrollTop=0},300),h(2)};return e.jsxs("div",{style:{width:a&&900},children:[e.jsx("div",{className:"flx ",children:e.jsxs("div",{className:"w-7 mr-2 mb-4 mt-2",children:[e.jsx("div",{className:"f-m",children:i("Integration name")}),e.jsx("input",{name:"name",onChange:s=>N(s),className:"btcd-paper-inp mt-1",type:"text",value:t.name,disabled:a})]})}),e.jsxs("div",{className:"flx flx-start",children:[e.jsxs("div",{className:"w-7",children:[e.jsx("div",{className:"f-m",children:i("Link:")}),e.jsx("input",{name:"url",onChange:s=>N(s),className:"btcd-paper-inp mt-1",type:"text",value:t.url,disabled:a}),(t==null?void 0:t.apiConsole)&&e.jsxs("small",{className:"d-blk mt-2",children:[i("To got Webhook , Please Visit")," ",e.jsx("a",{className:"btcd-link",href:t.apiConsole,target:"_blank",rel:"noreferrer",children:i(`${t.type} Dashboard`)})]})]}),e.jsxs("div",{className:"w-3 px-1",children:[e.jsx("div",{className:"f-m",children:i("Method:")}),e.jsx("select",{name:"method",onChange:s=>N(s),defaultValue:t.method,className:"btcd-paper-inp mt-1",disabled:a,children:E.map((s,l)=>e.jsx("option",{value:s,children:s},`method-${l*2}`))})]})]}),e.jsx("br",{}),e.jsx("div",{className:"f-m",children:i("Add Url Parameter: (optional)")}),e.jsx("div",{className:"btcd-param-t-wrp mt-1",children:e.jsxs("div",{className:"btcd-param-t",children:[e.jsxs("div",{className:"tr",children:[e.jsx("div",{className:"td",children:i("Key")}),e.jsx("div",{className:"td",children:i("Value")})]}),c(t.url)!==null&&((C=c(t.url))==null?void 0:C.map((s,l)=>e.jsxs("div",{className:"tr",children:[e.jsx("div",{className:"td",children:e.jsx("input",{className:"btcd-paper-inp p-i-sm",onChange:n=>b("key",n.target.value,s),type:"text",value:s.split("=")[0].substr(1),disabled:a})}),e.jsx("div",{className:"td",children:e.jsx("input",{className:"btcd-paper-inp p-i-sm",onChange:n=>b("val",n.target.value,s),type:"text",value:s.split("=")[1],disabled:a})}),!a&&e.jsxs("div",{className:"flx p-atn",children:[e.jsx(g,{onClick:()=>P(s),icn:!0,children:e.jsx(S,{size:16})}),e.jsxs("select",{className:"btcd-paper-inp p-i-sm",name:"",id:"",onChange:n=>F(n.target.value,s),defaultValue:s.split("=")[1],children:[e.jsx("option",{value:"",children:"Select One"}),e.jsx(q,{formFields:r,notAllowFieldType:["file-up","advanced-file-up"],shortCode:!0})]})]})]},`fu-1${l*3}`))),!a&&e.jsx(g,{onClick:()=>B(),className:"add-pram",icn:!0,children:e.jsx(M,{size:"14",className:"icn-rotate-45"})})]})}),!a&&e.jsxs(e.Fragment,{children:[e.jsxs(g,{onClick:()=>A(t),className:O(_.btn,_.btn_blue_otln),children:[i("Test Webhook"),o&&e.jsx(W,{size:14,clr:"#022217",className:"ml-2"}),e.jsx(I,{size:18,className:"ml-1"})]}),e.jsxs("div",{className:"wh-resp-box",children:[e.jsx("div",{className:"f-m wh-resp-box-title",children:i("Response:")}),e.jsx("div",{className:"wh-resp-box-content",ref:v,children:"Test Webhook to see the response."})]})]}),e.jsxs("small",{className:"d-blk mt-2 mb-2",children:[i("Try our free webhook test website: "),e.jsx("a",{className:"btcd-link",href:"https://app.webhook.is/test",target:"_blank",rel:"noreferrer",children:"https://app.webhook.is/test"})]}),y&&e.jsxs(G,{variant:"success",onClick:()=>R(),type:"button",children:[i("Next"),e.jsx(Q,{className:"ml-1 rev-icn"})]})]})}export{ae as default};
