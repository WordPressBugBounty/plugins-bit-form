var K=Object.defineProperty,Q=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var O=(d,i,n)=>i in d?K(d,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):d[i]=n,j=(d,i)=>{for(var n in i||(i={}))se.call(i,n)&&O(d,n,i[n]);if(D)for(var n of D(i))te.call(i,n)&&O(d,n,i[n]);return d},W=(d,i)=>Q(d,ee(i));import{r as h,b9 as ae,ba as H,j as e,h as M,u as V,v as oe,w as ne,a as A,a2 as ie,c as C,_ as c,m as L,C as le,dW as re,E as de,y as ce,a9 as N,S as me,e as ue,aY as he,b as pe,dX as be,b8 as xe,$ as z,dY as we,aR as F,dZ as B,I as U,g as fe,z as je,av as ge,s as ve,t as S}from"./main-917.js";import{P as Te}from"./bf-779-76.js";import{u as v}from"./bf-961-72.js";import{A as _e}from"./bf-210-310.js";import{L as Ee}from"./bf-292-78.js";import{L as ye}from"./bf-684-313.js";import{t as Ce}from"./bf-989-189.js";import"./bf-173-75.js";import"./bf-106-82.js";import"./bf-807-85.js";import"./bf-708-84.js";const Ne=ae(()=>H(()=>import("./bf-684-316.js"),["./bf-684-316.js","./main-917.js","./main-917.css"],import.meta.url),{fallback:e.jsx("div",{children:"Loading..."})});function Ve(){const[d,i]=h.useState(!1),[n,m]=h.useState({show:!1}),[b,w]=M(be),[t,g]=h.useState({show:!1,btnTxt:""}),a=V(xe),u=V(z),{formID:p,formType:o}=oe(),_=ne(),{css:f}=A(),E=ie(we);h.useEffect(()=>{E(),C({formID:p},"bitforms_get_views").then(s=>{if(s===void 0||!s.success)w([]),m({show:!0,msg:s.data});else if(s.success){const l=s.data.map(x=>W(j({},x),{shortcode:`[bitform-view id='${x.id}']`}));w(l)}})},[p]);const Y=s=>e.jsxs("div",{style:{lineHeight:.7,fontWeight:500},children:[F(s,u.dateFormat),e.jsx("br",{}),e.jsx("br",{}),e.jsx("small",{children:F(s,u.timeFormat)})]}),R=()=>{var s;if(!B((s=u==null?void 0:u.proInfo)==null?void 0:s.installedVersion,"2.9.0")){m({show:!0,msg:"To use this feature you need Bit Form Pro(Version: 2.9.0)"});return}_(`/form/settings/${o}/${p}/data-views/new`)},[$,k]=h.useState([{width:250,minWidth:80,Header:c("View Name"),accessor:"table_name",Cell:s=>e.jsx(L,{to:`/form/settings/${o}/${p}/data-views/${s.row.original.id}`,type:"button",className:"btcd-tabl-lnk",children:s.row.original.table_name})},{width:220,minWidth:200,Header:c("Short Code"),accessor:"shortcode",Cell:s=>e.jsx(le,{value:s.row.values.shortcode,className:`cpyTxt ${f({w:230})}`})},{width:160,minWidth:60,Header:c("Created"),accessor:"created_at",Cell:s=>Y(s.row.original.created_at)}]);h.useEffect(()=>{const s=$.filter(l=>l.accessor!=="t_action");s.push({sticky:"right",width:100,minWidth:60,Header:"Actions",accessor:"t_action",Cell:l=>e.jsxs(re,{title:"Actions",w:165,h:107,children:[e.jsxs(L,{to:`/form/settings/${o}/${p}/data-views/${l.row.original.id}`,type:"button",className:"flx","aria-label":"actions",children:[e.jsx(de,{size:18}),c("Edit Table")]}),e.jsxs("button",{type:"button",onClick:()=>G(l.row.original.id,l.row.index),children:[e.jsx(ce,{size:16}),"Â ",c("Delete")]})]})}),k([...s])},[a]);const X=h.useCallback(s=>{const l=[],x=[];for(let r=0;r<s.length;r+=1)l.push(s[r].id),x.push(s[r].original.id);const y=[...b],P=[...b];for(let r=l.length-1;r>=0;r-=1)P.splice(Number(l[r]),1);w(r=>N(r,{data:P,type:"set"})),C({tblId:x},"bitforms_bulk_table_delete_form").then(r=>{r===void 0||!r.success?w(J=>N(J,{data:y,type:"set"})):r.success&&m({show:!0,msg:r.data})})},[]),Z=(s,l)=>{C({id:s},"bitforms_delete_atable").then(x=>{x.success&&(w(y=>N(y,{type:"remove",data:l})),m({show:!0,msg:c("Table Deleted Successfully")}))})},q=h.useCallback(s=>{k(s)},[]),I=()=>{t.show=!1,g(j({},t))},G=(s,l)=>{t.action=()=>{Z(s,l),I()},t.btnTxt=c("Delete"),t.btn2Txt=null,t.btnClass="",t.body=c("Are you sure to delete this table?"),t.show=!0,g(j({},t))};return e.jsxs("div",{id:"all-forms",children:[e.jsx(me,{snack:n,setSnackbar:m}),e.jsx(ue,{show:t.show,body:t.body,action:t.action,close:I,btnTxt:t.btnTxt,btn2Txt:t.btn2Txt,btn2Action:t.btn2Action,btnClass:t.btnClass}),b.length?e.jsx("div",{children:e.jsx(he,{className:"f-table btcd-all-frm",leftHeaderClasses:f(Re.leftHeader),height:525,columns:$,data:b,rowSeletable:!0,newTableId:a,resizable:!0,setBulkDelete:X,setTableCols:q,centerHeader:e.jsx("h3",{children:"Data View List (Beta)"}),rightHeader:e.jsx("button",{onClick:()=>R(),type:"button","data-testid":"create-table-btn",className:`round btcd-btn-lg blue blue-sh ${f(pe.btn)}`,children:c("Create View")})})}):e.jsx(Ne,{setModal:i,createNewView:R})]})}var Ae=h.memo(Ve);const Re={leftHeader:{width:"auto !important"}};function $e(){var p;const[d,i]=M(ge),n=V(z),{css:m}=A(),{userRoles:b,user:w}=n,t=Object.keys(b).map(o=>({label:b[o].name,value:o})),g=[{label:"All Logged In Users",value:"all_logged_in_users"},...t],{entryEditAccess:a}=d||{},u=(o,_)=>{U&&i(f=>fe(f,E=>{je(E,o,_)}))};return e.jsxs("div",{children:[e.jsx("h3",{children:"Views And Edit Access (Beta)"}),!B((p=n==null?void 0:n.proInfo)==null?void 0:p.installedVersion,"2.9.0")&&e.jsxs("p",{children:[e.jsx("strong",{style:{color:"red"},children:" Note:"})," ","To use this feature you need Bit Form Pro(Version: 2.9.0)"," "]}),e.jsx(_e,{customTitle:e.jsxs("span",{className:m({dy:"flex"}),children:[e.jsxs("b",{children:[e.jsx("span",{className:"mr-2",children:e.jsx(ye,{size:20})}),c("Allow Users to Edit Form Entries")]}),e.jsx(Ee,j({},Ce.allowUserToEdit))]}),toggle:!0,action:o=>u("entryEditAccess->allowEntriesEdit",o.target.checked),checked:a==null?void 0:a.allowEntriesEdit,cls:"w-10 mt-3",isPro:!0,proProperty:"is_login",children:e.jsxs("div",{className:m({p:"5px 10px"}),children:[e.jsxs("div",{className:m(T.inputWrp),children:[e.jsx("span",{children:c("Allow Roles to edit won entries")}),e.jsx(v,{defaultValue:(a==null?void 0:a.allowEditOwnEntries)||[],className:"btcd-paper-drpdwn w-6",options:g,onChange:o=>u("entryEditAccess->allowEditOwnEntries",o)})]}),e.jsxs("div",{className:m(T.inputWrp),children:[e.jsx("span",{children:c("Allow Roles to edit Other's entries")}),e.jsx(v,{defaultValue:(a==null?void 0:a.allowEditOtherEntries)||[],className:"btcd-paper-drpdwn w-6",options:t,onChange:o=>u("entryEditAccess->allowEditOtherEntries",o)})]}),e.jsxs("div",{className:m(T.inputWrp),children:[e.jsx("span",{children:c("Prevent Roles to edit entries")}),e.jsx(v,{defaultValue:(a==null?void 0:a.preventRolesToEditEntries)||[],className:"btcd-paper-drpdwn w-6",options:t,onChange:o=>u("entryEditAccess->preventRolesToEditEntries",o)})]}),e.jsxs("div",{className:m(T.inputWrp),children:[e.jsx("span",{children:c("Prevent Roles to edit Other's entries")}),e.jsx(v,{defaultValue:(a==null?void 0:a.preventRolesToEditOtherentries)||[],className:"btcd-paper-drpdwn w-6",options:t,onChange:o=>u("entryEditAccess->preventRolesToEditOtherentries",o)})]})]})})]})}const T={inputWrp:{dy:"flex",jc:"space-between",ai:"center",mb:10}};function ke(){const{css:d}=A();return e.jsxs("div",{className:d({pr:75}),children:[!U&&e.jsx(Te,{style:{height:"90%",left:"30px",width:"95%","margin-top":"40px"}}),e.jsx($e,{}),e.jsx("hr",{}),e.jsx(Ae,{})]})}const Ie=h.lazy(()=>H(()=>import("./bf-583-317.js"),["./bf-583-317.js","./main-917.js","./main-917.css","./bf-173-75.js","./bf-851-414.css","./bf-961-72.js","./bf-536-413.css","./bf-558-146.js","./bf-484-183.js","./bf-738-114.js","./bf-106-82.js","./bf-708-84.js","./bf-807-85.js","./bf-582-315.js","./bf-24-113.js","./bf-16-112.js","./bf-104-416.css","./bf-753-116.js","./bf-527-115.js","./bf-857-83.js","./bf-548-152.js","./bf-472-314.js","./bf-781-153.js","./bf-331-74.js","./bf-37-311.js","./bf-376-417.css","./bf-284-107.js","./bf-675-193.js","./bf-657-194.js","./bf-423-140.js","./bf-624-141.js","./bf-779-76.js","./bf-811-111.js"],import.meta.url));function Xe(){return e.jsxs(ve,{children:[e.jsx(S,{index:!0,element:e.jsx(ke,{})}),e.jsx(S,{path:"/:viewId",element:e.jsx(Ie,{})})]})}export{Xe as default};
