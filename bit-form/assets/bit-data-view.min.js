var bit_data_view=function(){"use strict";class e{#e={};#t=null;#s=null;#a=null;#i=null;#r=null;#n=null;#l=null;#c=[];#o=0;#h=10;#d=null;#p=null;#u=10;#f=1;#g=null;#b=null;#m=null;#$={};#y=[];#w={};#E=null;#v=null;#P=null;#I=null;#C={};#S={};#T=[];#k=null;#F=null;constructor(e,t){Object.assign(this.#e,t),this.#t=t?.document||document,this.#s=t?.window||window,this.#b=t.formId,this.#m=t.viewId,this.#$=t.tableConfig,this.#y=t.tableConfig.columnsMap,this.#w=t.tableConfig.actionsBtn,this.#d=t.totalRecords,this.#S=t.accessControl,this.#T=t?.formFields,this.#l="string"==typeof e?this.#t.querySelector(e):e,this.#E=this.#s.bf_view_globals.entries,this.#C=this.#s.bf_view_globals.userInfo,this.#k=this.#s.bf_view_globals.uploadUrl,this.init()}init(){this.#_(),this.#O(),this.#M(),this.#B(),this.#h=Math.ceil(this.#d/this.#u),this.#I.innerHTML=this.#h,this.#x()}#x(){this.#n[0].disabled=0===this.#o,this.#n[1].disabled=0===this.#o,this.#n[2].disabled=this.#o===this.#h-1,this.#n[3].disabled=this.#o===this.#h-1}#_(){this.#n=this.#l.querySelectorAll(`.bf${this.#b}-${this.#m}-pgn-btn`),this.#p=this.#L(`.bf${this.#b}-${this.#m}-tbl-pgn-slt`),this.#r=this.#L(`.bf${this.#b}-${this.#m}-tbody`),this.#v=this.#L(`.bf${this.#b}-${this.#m}-serc-bx`),this.#P=this.#L(`.bf${this.#b}-${this.#m}-curr-page`),this.#I=this.#L(`.bf${this.#b}-${this.#m}-total-page`)}clear(){this.#l.innerHTML="",this.#N()}#N(){this.#c.forEach(({selector:e,eventType:t,cb:s})=>{e.removeEventListener(t,s)})}#j(e,t,s){e.addEventListener(t,s),this.#c.push({selector:e,eventType:t,cb:s})}#L(e){return this.#l.querySelector(e)}#M(){this.#j(this.#p,"change",e=>{e.preventDefault();const t=e.target.value;this.#u=parseInt(t,10),this.#h=Math.ceil(this.#d/this.#u),this.#I.innerHTML=this.#h,this.#x(),this.#P.innerHTML=1,this.#A()})}#O(){this.#n.forEach(e=>{this.#j(e,"click",e=>{switch(e.preventDefault(),e.target.dataset.page){case"start":this.#o=0;break;case"end":this.#o=this.#h-1;break;case"previous":this.#o>=1&&(this.#o-=1);break;case"next":this.#o<this.#h&&(this.#o+=1);break;default:console.log("value not found")}this.#x(),this.#P.innerHTML=this.#o+1,this.#A()})})}debounce(e,t,s){let a;return function(){const i=this,r=arguments,n=s&&!a;clearTimeout(a),a=setTimeout(function(){a=null,s||e.apply(i,r)},t),n&&e.apply(i,r)}}#B(){this.#j(this.#v,"keyup",this.debounce(e=>{let t;t=e.target.value?this.#z(e.target.value):this.#E,this.#H(t)},500))}#z(e){const t=e.toLowerCase(),s={};return Object.keys(this.#E).forEach(e=>{const a=this.#E[e];for(const i in a)a[i].toLowerCase().includes(t)&&(s[e]=a)}),s}#R(){return this.#S,!0}#D(){return this.#S,!0}#U(e){const t=this.#J("td"),s=this.#J("div"),a=this.#w.editButton,i=this.#w.viewButton,{entryEditAccess:r,entryViewAccess:n}=this.#S;if(this.#C,this.#V(s,`bf${this.#b}-${this.#m}-tbl-action-btns`),a.show&&r?.allowEntriesEdit){const t=this.#J("a");t.innerHTML=a.btnTxt,this.#V(t,`bf${this.#b}-${this.#m}-tbl-edit-btn`),t.href=`${a.slug}?bf_entry_id=${e}`,this.#W(s,t)}if(i.show){const t=this.#J("a");t.innerHTML=i.btnTxt,this.#V(t,`bf${this.#b}-${this.#m}-tbl-view-btn`),t.href=`${i.slug}?bf_entry_id=${e}`,this.#W(s,t)}return this.#W(t,s),t}#A(){let e=0;0!==this.#o&&(e=this.#o*this.#u),async function(e,t,s=null,a=null){if(!bf_view_globals)return!1;const i=new URL(bf_view_globals?.ajaxURL);if(i.searchParams.append("action",t),a)for(const e in a)e&&i.searchParams.append(e,a[e]);return await fetch(i,{method:"POST",headers:{"Content-Type":null===s?"application/x-www-form-urlencoded":s},body:e instanceof FormData?e:JSON.stringify(e)}).then(e=>e.json())}({formId:this.#b,tableId:this.#m,offset:e,pageSize:this.#u},"bitforms_get_entries").then(e=>{const{data:t}=e,s=Object.keys(t).sort((e,t)=>t-e),a={};s.forEach(e=>{a[e]=t[e]}),this.#E=a,this.#H(this.#E)})}#q(e){switch(e.toLowerCase()){case"xbm":case"tif":case"pjp":case"pjpeg":case"svgz":case"jpg":case"jpeg":case"ico":case"tiff":case"gif":case"svg":case"bmp":case"png":case"jfif":case"webp":return"image";case"7z":case"arj":case"deb":case"pkg":case"rar":case"rpm":case"gz":case"z":case"zip":return"compressed";case"key":case"odp":case"pps":case"ppt":case"pptx":return"presentation";case"_rf_":case"doc":case"docx":case"odt":case"pdf":case"rtf":case"tex":case"txt":case"wks":case"wps":case"wpd":return"document";case"csv":case"dat":case"db":case"dbf":case"log":case"mdb":case"sav":case"sql":case"tar":case"sqlite":case"xml":return"data";case"opus":case"flac":case"webm":case"weba":case"wav":case"ogg":case"m4a":case"mp3":case"oga":case"mid":case"amr":case"aiff":case"wma":case"au":case"acc":case"wpl":return"audio";case"ogm":case"wmv":case"mpg":case"ogv":case"mov":case"asx":case"mpeg":case"mp4":case"m4v":case"avi":case"3gp":case"flv":case"mkv":case"swf":return"video";default:return"other"}}#Z(e,t,s,a){const i=`${this.#F||this.#k}${e}`,r=this.#J("img");return r.src=e?i:"",r.alt=t||"",r.style.display="block",void 0!==s?r.style.width=s:r.width=250,void 0!==a&&(r.style.height=a),r}#G(e,t,s){const a=`${this.#F||this.#k}${e}`,i=this.#J("a");return i.href=a,i.setAttribute("target","_blank"),i.setAttribute("rel","noopener noreferrer"),i.textContent=e,i.style.color="blue",i.style.display="block",void 0!==t&&(i.style.width=t),void 0!==s&&(i.style.height=s),i}#K(e){const t=this.#J("ul");return t.style.listStyleType="none",t.style.padding=0,t.style.margin=0,e.forEach(e=>{const s=this.#J("li"),a=this.#G(e);this.#W(s,a),this.#W(t,s)}),t}#Q(e,t,s){const a=this.#J("table");if(a.style.width="100%",this.#X(e)){const i=JSON.parse(e),r=this.#J("tr");return Object.keys(i[0]).forEach(e=>{const t=this.#T[e],s=t?.lbl||t?.fieldName||t?.typ||e,a=this.#J("th");a.style.textAlign="left",a.textContent=s,this.#W(r,a)}),this.#W(a,r),i.forEach(e=>{const i=this.#J("tr");let r;Object.keys(e).forEach(a=>{if(r=this.#J("td"),r.style.whiteSpace="nowrap",this.#Y(a)){const i=this.#ee(e[a],t,s);this.#W(r,i)}else if(Array.isArray(e[a]))e[a].forEach((e,t,s)=>{if(this.#te(e))if(this.#se(e)){const t=this.#Z(e,e);this.#W(r,t)}else{const t=this.#G(e,"100%");this.#W(r,t)}else{const a=this.#J("span");a.textContent=t===s.length-1?e:`${e}, `,this.#W(r,a)}});else{const t=this.#J("span");t.textContent=e[a],this.#W(r,t)}this.#W(i,r)}),this.#W(a,i)}),a}return a}#ee(e,t,s){this.#F=t[s]?.resourcePath;const a=this.#X(e)?JSON.parse(e):e;if(Array.isArray(a))return this.#K(a);let i;return this.#te(e)?(i="signature-failed.png"===e?this.#Z("",""):this.#Z(e,e),i):(i=e,i)}#ae(e){const t=e.lastIndexOf(".");return e.substring(t+1)}#te(e){const t=this.#ae(e);return"other"!==this.#q(t)}#se(e){const t=this.#ae(e);return"image"===this.#q(t)}#Y(e){return e in this.#T&&["advanced-file-up","signature","file-up"].includes(this.#T[e].typ)}#ie(e){return e in this.#T&&"repeater"===this.#T[e].typ}#re(e,t){return`${e=e.replace(/\/+$/,"")}/${t=t.replace(/^\/+/,"")}`}#ne(e){const t={...e};return Object.keys(t).forEach(e=>{Object.entries(t[e]).forEach(([s,a])=>{const i=this.#X(a)?JSON.parse(a):a,r=s.replace(/\${([a-zA-Z0-9]+-\d+)}/g,"$1");this.#ie(r)&&i.forEach(s=>{Object.entries(s).forEach(([s,a])=>{const{resourcePath:i}=t[e];if(this.#Y(s))if(Array.isArray(a)){const r=`[${a.map(e=>{const t=this.#re(i,e);return this.#te(e)?this.#se(e)?`<img src=${t} alt=${e} width='250'/>`:`<a href=${t} rel='noopener noreferrer' target='_blank' style='color:blue'>${e}</a>`:e}).join(", ")}]`;t[e][`\${${s}}`]=t[e][`\${${s}}`]?`${t[e][`\${${s}}`]}, ${r}`:r}else if(this.#te(a)){const r=this.#re(i,a);if(this.#se(a)&&"signature-failed.png"!==a){const i=`<img src=${r} alt=${a} width='250'/>`;t[e][`\${${s}}`]=t[e][`\${${s}}`]?`${t[e][`\${${s}}`]}, ${i}`:i}else{const i=`<a href=${r} rel='noopener noreferrer' target='_blank' style='color:blue'>${a}</a>`;t[e][`\${${s}}`]=t[e][`\${${s}}`]?`${t[e][`\${${s}}`]}, ${i}`:i}}else t[e][`\${${s}}`]=t[e][`\${${s}}`]?`${t[e][`\${${s}}`]}, ${a}`:a;else t[e][`\${${s}}`]=t[e][`\${${s}}`]?`${t[e][`\${${s}}`]}, ${a}`:a})})})}),t}#H(e){this.#r.innerHTML="";const{head:t}=this.#$.actionsBtn;this.#ne(e),Object.keys(e).forEach(s=>{const a=this.#J("tr");if(this.#y.forEach(t=>{const i=this.#J("td"),r=t.fk.replace(/\${([a-zA-Z0-9]+-\d+)}/g,"$1"),n=e[s][t.fk];if(this.#Y(r)){const t=this.#ee(n,e,s);t instanceof Node?this.#W(i,t):i.innerHTML+=t}else if(this.#ie(r)){const t=this.#Q(n,e,s);this.#W(i,t)}else if(this.#X(n)){const e=JSON.parse(n);Array.isArray(e)&&(i.textContent=e.join(", "))}else i.textContent=n;this.#W(a,i)}),t?.show&&(this.#R()||this.#D())){const e=this.#U(s);this.#W(a,e)}this.#W(this.#r,a)})}#X(e){try{JSON.parse(e)}catch(e){return!1}return!0}#J(e){return this.#t.createElement(e)}#le(e){return this.#t.createTextNode(e)}#V(e,t){e.classList.add(t)}#W(e,t){e.appendChild(t)}}return document.addEventListener("DOMContentLoaded",()=>{void 0!==bit_data_view?bit_data_view():console.error("bit_data_view is not defined")}),function(){Object.keys(window?.bf_view_globals.bf_tables||{}).forEach(t=>{const s=window.bf_view_globals.bf_tables[t];if(s){const{formId:t,viewId:i}=s,r=(a=`.bf${t}-${i}-tbl-wrp`,document.querySelector(a));s.inits=new e(r,s)}var a})}}();
