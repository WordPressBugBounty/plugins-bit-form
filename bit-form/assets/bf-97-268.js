var se=Object.defineProperty,te=Object.defineProperties;var ae=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var H=(d,l,n)=>l in d?se(d,l,{enumerable:!0,configurable:!0,writable:!0,value:n}):d[l]=n,g=(d,l)=>{for(var n in l||(l={}))oe.call(l,n)&&H(d,n,l[n]);if(F)for(var n of F(l))ne.call(l,n)&&H(d,n,l[n]);return d},S=(d,l)=>te(d,ae(l));import{r as p,bs as le,H as G,j as e,i as Y,u as V,g as ie,G as re,a as P,ar as ce,I as k,c as N,_ as o,s as L,C as de,em as me,E as ue,W as he,ay as A,S as pe,d as xe,bg as be,b as we,en as fe,br as je,$ as q,eo as ge,ba as O,Y as J,f as _e,m as ve,aU as Ee,D as Te,F as M}from"./main-861.js";import{P as ye}from"./bf-307-80.js";import{u as v}from"./bf-857-79.js";import{A as z}from"./bf-562-83.js";import{L as U}from"./bf-496-84.js";import{E as Ce}from"./bf-834-85.js";import{E as Ne}from"./bf-922-251.js";import{t as B}from"./bf-914-82.js";import"./bf-662-86.js";import"./bf-441-88.js";const Ae=le(()=>G(()=>import("./bf-440-380.js"),["./bf-440-380.js","./main-861.js","./main-861.css"],import.meta.url),{fallback:e.jsx("div",{children:"Loading..."})});function Ve(){const[d,l]=p.useState(!1),[n,m]=p.useState({show:!1}),[x,w]=Y(fe),[a,f]=p.useState({show:!1,btnTxt:""}),u=V(je),i=V(q),{formID:h,formType:j}=ie(),t=re(),{css:_}=P(),T=ce(ge);p.useEffect(()=>{T(),k&&N({formID:h},"bitforms_get_views").then(s=>{if(s===void 0||!s.success)w([]),m({show:!0,msg:s.data});else if(s.success){const r=s.data.map(b=>S(g({},b),{shortcode:`[bitform-view id='${b.id}']`}));w(r)}})},[h]);const y=s=>e.jsxs("div",{style:{lineHeight:.7,fontWeight:500},children:[O(s,i.dateFormat),e.jsx("br",{}),e.jsx("br",{}),e.jsx("small",{children:O(s,i.timeFormat)})]}),$=()=>{var s;if(!J((s=i==null?void 0:i.proInfo)==null?void 0:s.installedVersion,"2.9.0")){m({show:!0,msg:"To use this feature you need Bit Form Pro(Version: 2.9.0)"});return}t(`/form/settings/${j}/${h}/data-views/new`)},[I,D]=p.useState([{width:250,minWidth:80,Header:o("View Name"),accessor:"table_name",Cell:s=>e.jsx(L,{to:`/form/settings/${j}/${h}/data-views/${s.row.original.id}`,type:"button",className:"btcd-tabl-lnk",children:s.row.original.table_name})},{width:220,minWidth:200,Header:o("Short Code"),accessor:"shortcode",Cell:s=>e.jsx(de,{value:s.row.values.shortcode,className:`cpyTxt ${_({w:230})}`})},{width:160,minWidth:60,Header:o("Created"),accessor:"created_at",Cell:s=>y(s.row.original.created_at)}]);p.useEffect(()=>{const s=I.filter(r=>r.accessor!=="t_action");s.push({sticky:"right",width:100,minWidth:60,Header:o("Actions"),accessor:"t_action",Cell:r=>e.jsxs(me,{title:o("Actions"),w:165,h:107,children:[e.jsxs(L,{to:`/form/settings/${j}/${h}/data-views/${r.row.original.id}`,type:"button",className:"flx","aria-label":"actions",children:[e.jsx(ue,{size:18}),o("Edit Table")]}),e.jsxs("button",{type:"button",onClick:()=>Z(r.row.original.id,r.row.index),children:[e.jsx(he,{size:16}),"Â ",o("Delete")]})]})}),D([...s])},[u]);const K=p.useCallback(s=>{const r=[],b=[];for(let c=0;c<s.length;c+=1)r.push(s[c].id),b.push(s[c].original.id);const C=[...x],W=[...x];for(let c=r.length-1;c>=0;c-=1)W.splice(Number(r[c]),1);w(c=>A(c,{data:W,type:"set"})),N({tblId:b},"bitforms_bulk_table_delete_form").then(c=>{c===void 0||!c.success?w(ee=>A(ee,{data:C,type:"set"})):c.success&&m({show:!0,msg:c.data})})},[x]),Q=(s,r)=>{N({id:s},"bitforms_delete_atable").then(b=>{b.success&&(w(C=>A(C,{type:"remove",data:r})),m({show:!0,msg:o("Table Deleted Successfully")}))})},X=p.useCallback(s=>{D(s)},[]),R=()=>{a.show=!1,f(g({},a))},Z=(s,r)=>{a.action=()=>{Q(s,r),R()},a.btnTxt=o("Delete"),a.btn2Txt=null,a.btnClass="",a.body=o("Are you sure to delete this table?"),a.show=!0,f(g({},a))};return e.jsxs("div",{id:"all-forms",children:[e.jsx(pe,{snack:n,setSnackbar:m}),e.jsx(xe,{show:a.show,body:a.body,action:a.action,close:R,btnTxt:a.btnTxt,btn2Txt:a.btn2Txt,btn2Action:a.btn2Action,btnClass:a.btnClass}),x.length?e.jsx("div",{children:e.jsx(be,{className:"f-table btcd-all-frm",leftHeaderClasses:_(ke.leftHeader),height:525,columns:I,data:x,rowSeletable:!0,newTableId:u,resizable:!0,setBulkDelete:K,setTableCols:X,centerHeader:e.jsx("h3",{children:"Data View List (Beta)"}),rightHeader:e.jsx("button",{onClick:()=>$(),type:"button","data-testid":"create-table-btn",className:`round btcd-btn-lg blue blue-sh ${_(we.btn)}`,children:o("Create View")})})}):e.jsx(Ae,{setModal:l,createNewView:$})]})}var Pe=p.memo(Ve);const ke={leftHeader:{width:"auto !important"}};function $e(){var j;const[d,l]=Y(Ee),n=V(q),{css:m}=P(),{userRoles:x,user:w}=n,a=Object.keys(x).filter(t=>t!=="administrator").map(t=>({label:x[t].name,value:t})),f=[{label:"All Logged In Users",value:"all_logged_in_users"},...a],{entryEditAccess:u,entryViewAccess:i}=d||{},h=(t,_)=>{k&&l(T=>_e(T,y=>{ve(y,t,_)}))};return e.jsxs("div",{children:[e.jsx("h3",{children:"Views And Edit Access"}),!J((j=n==null?void 0:n.proInfo)==null?void 0:j.installedVersion,"2.9.0")&&e.jsxs("p",{children:[e.jsx("strong",{style:{color:"red"},children:" Note:"})," ","To use this feature you need Bit Form Pro(Version: 2.9.0)"," "]}),e.jsx(z,{customTitle:e.jsxs("span",{className:m({flx:"align-center"}),children:[e.jsx("span",{className:"mr-2",children:e.jsx(Ne,{size:18})}),e.jsx("b",{children:o("Prevent Public View of Entries")}),e.jsx("small",{className:"ml-1",children:o("(Allow only selected rules to View Entries)")}),e.jsx(U,g({},B.allowUserToView))]}),toggle:!0,action:t=>h("entryViewAccess->preventPublicAccess",t.target.checked),checked:i==null?void 0:i.preventPublicAccess,cls:"w-10 mt-3",isPro:!0,proProperty:"is_login",children:e.jsxs("div",{className:m({p:"5px 10px"}),children:[e.jsxs("div",{className:m(E.inputWrp),children:[e.jsx("span",{children:o("Allow Roles to view own entries")}),e.jsx(v,{defaultValue:(i==null?void 0:i.ownEntries)||[],className:"btcd-paper-drpdwn w-6",options:f,onChange:t=>h("entryViewAccess->ownEntries",t)})]}),e.jsxs("div",{className:m(E.inputWrp),children:[e.jsx("span",{children:o("Allow Roles to view Other's entries")}),e.jsx(v,{defaultValue:(i==null?void 0:i.othersEntries)||[],className:"btcd-paper-drpdwn w-6",options:f,onChange:t=>h("entryViewAccess->othersEntries",t)})]})]})}),e.jsx(z,{customTitle:e.jsxs("span",{className:m({dy:"flex"}),children:[e.jsx("span",{className:"mr-2",children:e.jsx(Ce,{size:20})}),e.jsx("b",{children:o("Allow Users to Edit Form Entries")}),e.jsx(U,g({},B.allowUserToEdit))]}),toggle:!0,action:t=>h("entryEditAccess->allowEntriesEdit",t.target.checked),checked:u==null?void 0:u.allowEntriesEdit,cls:"w-10 mt-3",isPro:!0,proProperty:"is_login",children:e.jsxs("div",{className:m({p:"5px 10px"}),children:[e.jsxs("div",{className:m(E.inputWrp),children:[e.jsx("span",{children:o("Allow Roles to edit own entries")}),e.jsx(v,{defaultValue:(u==null?void 0:u.ownEntries)||[],className:"btcd-paper-drpdwn w-6",options:f,onChange:t=>h("entryEditAccess->ownEntries",t)})]}),e.jsxs("div",{className:m(E.inputWrp),children:[e.jsx("span",{children:o("Allow Roles to edit Other's entries")}),e.jsx(v,{defaultValue:(u==null?void 0:u.othersEntries)||[],className:"btcd-paper-drpdwn w-6",options:a,onChange:t=>h("entryEditAccess->othersEntries",t)})]})]})})]})}const E={inputWrp:{dy:"flex",jc:"space-between",ai:"center",mb:10}};function Ie(){const{css:d}=P();return e.jsxs("div",{className:d({pr:75}),children:[!k&&e.jsx(ye,{style:{height:"90%",left:"30px",width:"95%","margin-top":"40px"}}),e.jsx($e,{}),e.jsx("hr",{}),e.jsx(Pe,{})]})}const De=p.lazy(()=>G(()=>import("./bf-563-381.js"),["./bf-563-381.js","./main-861.js","./main-861.css","./bf-857-79.js","./bf-932-408.css","./bf-95-70.js","./bf-528-113.js","./bf-951-407.css","./bf-405-283.js","./bf-296-322.js","./bf-110-250.js","./bf-662-86.js","./bf-441-88.js","./bf-645-249.js","./bf-27-379.js","./bf-631-248.js","./bf-550-247.js","./bf-184-409.css","./bf-17-253.js","./bf-212-252.js","./bf-684-87.js","./bf-158-289.js","./bf-11-378.js","./bf-395-290.js","./bf-619-78.js","./bf-257-376.js","./bf-447-411.css","./bf-361-242.js","./bf-545-181.js","./bf-654-324.js","./bf-775-325.js","./bf-708-277.js","./bf-69-278.js","./bf-307-80.js","./bf-384-246.js"],import.meta.url));function Ye(){return e.jsxs(Te,{children:[e.jsx(M,{index:!0,element:e.jsx(Ie,{})}),e.jsx(M,{path:"/:viewId",element:e.jsx(De,{})})]})}export{Ye as default};
