var j=Object.defineProperty;var l=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var v=(s,e,t)=>e in s?j(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,x=(s,e)=>{for(var t in e||(e={}))D.call(e,t)&&v(s,t,e[t]);if(l)for(var t of l(e))w.call(e,t)&&v(s,t,e[t]);return s};import{w as O,v as I,r,j as o,S as b}from"./main-281.js";import"./bf-9-69.js";import{S as C}from"./bf-129-119.js";import{s as N,b as k}from"./bf-881-74.js";import{I as y}from"./bf-635-329.js";import{N as L}from"./bf-508-399.js";import E from"./bf-959-254.js";import{O as F}from"./bf-216-387.js";import"./bf-151-72.js";import"./bf-191-185.js";import"./bf-496-398.js";import"./bf-44-386.js";function K({formFields:s,setIntegration:e,integrations:t,allIntegURL:g}){const u=O(),{flowID:m}=I(),[c,p]=r.useState(!1),[a,f]=r.useState(1),[h,n]=r.useState({show:!1}),[i,d]=r.useState({name:"OneDrive",type:"OneDrive",clientId:"",clientSecret:"",field_map:[{formField:"",OneDriveFormField:""}],folder:"",folderMap:[],foldersList:[],actions:{}});r.useEffect(()=>{window.opener&&N("oneDrive")},[]);const S=()=>{k(t,e,g,i,u)};return o.jsxs("div",{children:[o.jsx(b,{snack:h,setSnackbar:n}),o.jsx("div",{className:"txt-center w-9 mt-2 cal-width",children:o.jsx(C,{step:3,active:a})}),o.jsx(E,{flowID:m,oneDriveConf:i,setOneDriveConf:d,step:a,setStep:f,isLoading:c,setIsLoading:p,setSnackbar:n}),o.jsxs("div",{className:"btcd-stp-page",style:x({},a===2&&{width:900,height:"100%",overflow:"visible"}),children:[o.jsx(F,{flowID:m,formFields:s,oneDriveConf:i,setOneDriveConf:d,isLoading:c,setIsLoading:p,setSnackbar:n}),o.jsx(L,{nextPageHandler:()=>f(3),disabled:!i.actions.attachments||!i.folder})]}),o.jsx(y,{step:a,saveConfig:()=>S()})]})}export{K as default};
